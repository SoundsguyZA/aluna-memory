# VERITAS VPS - Complete System Architecture

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                              WINDOWS DESKTOP (Client)                          ║
║  ┌──────────────────┐  ┌──────────────────┐  ┌─────────────────────────┐    ║
║  │ Remote Desktop   │  │  Web Browser     │  │  PowerShell Launcher    │    ║
║  │  (RDP Client)    │  │  (Chrome/Edge)   │  │  Deploy-Veritas-VPS.ps1 │    ║
║  │  mstsc.exe       │  │                  │  │                         │    ║
║  └────────┬─────────┘  └─────────┬────────┘  └────────────┬────────────┘    ║
╚═══════════┼════════════════════════┼═════════════════════════┼═══════════════╝
            │                        │                         │
            │ Port 3389              │ Ports 50003-50004       │ SSH Port 22
            │ (RDP)                  │ 9443 (HTTPS)            │
            └────────────────────────┼─────────────────────────┘
                                    │
                                    ▼
╔═══════════════════════════════════════════════════════════════════════════════╗
║                    VPS: veritas.alunaafrica.cloud                             ║
║                         IP: 72.62.235.217                                     ║
║                    Hostinger KVM2: 2 vCPU, 8GB RAM                           ║
║                        Ubuntu 24.04 LTS                                       ║
╠═══════════════════════════════════════════════════════════════════════════════╣
║                                                                               ║
║  ┌─────────────────────────────────────────────────────────────────────┐    ║
║  │                     XFCE Desktop + XRDP (Port 3389)                  │    ║
║  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────────────┐      │    ║
║  │  │ VS Code      │  │  Terminal     │  │  Firefox Browser     │      │    ║
║  │  │              │  │  Docker CLI   │  │  (Portainer Access)  │      │    ║
║  │  └──────────────┘  └──────────────┘  └──────────────────────┘      │    ║
║  └─────────────────────────────────────────────────────────────────────┘    ║
║                                                                               ║
║  ┌─────────────────────────────────────────────────────────────────────┐    ║
║  │                        Nginx Reverse Proxy                           │    ║
║  │                     (Ports 80/443 - SSL/HTTPS)                       │    ║
║  │                                                                       │    ║
║  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐             │    ║
║  │  │ agent.       │  │ memory.      │  │ vault.       │             │    ║
║  │  │ veritas...   │  │ veritas...   │  │ veritas...   │             │    ║
║  │  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘             │    ║
║  └─────────┼──────────────────┼──────────────────┼────────────────────┘    ║
║            │                  │                  │                           ║
╠════════════┼══════════════════┼══════════════════┼═══════════════════════════╣
║            │   DOCKER NETWORK (veritas-network)  │                           ║
╠════════════┼══════════════════┼══════════════════┼═══════════════════════════╣
║            │                  │                  │                           ║
║  ┌─────────▼───────┐  ┌───────▼────────┐  ┌────▼──────────────────────┐   ║
║  │  Agent Zero     │  │ Aluna-Memory   │  │    CogniVault            │   ║
║  │   (Future)      │  │  (Port 50003)  │  │    (Port 50004)          │   ║
║  │  Port 50001     │  │                │  │                          │   ║
║  │  ┌───────────┐  │  │  ┌──────────┐ │  │  ┌────────────────────┐  │   ║
║  │  │ AI Agent  │  │  │  │  Mem0    │ │  │  │  Streamlit UI     │  │   ║
║  │  │ Framework │  │  │  │Framework │ │  │  │  Multi-tab        │  │   ║
║  │  └───────────┘  │  │  │          │ │  │  └─────────┬──────────┘  │   ║
║  └─────────────────┘  │  │  Memory  │ │  │            │             │   ║
║                       │  │  Graph   │ │  │  ┌─────────▼──────────┐  │   ║
║  ┌─────────────────┐  │  │  Semantic│ │  │  │  Document         │  │   ║
║  │  ClawdBot       │  │  │  Search  │ │  │  │  Processors       │  │   ║
║  │   (Future)      │  │  │          │ │  │  │  - WhatsApp       │  │   ║
║  │  Port 50002     │  │  └────┬─────┘ │  │  │  - ChatGPT        │  │   ║
║  │  ┌───────────┐  │  │       │       │  │  │  - Audio          │  │   ║
║  │  │ Telegram  │  │  │       │       │  │  │  - PDF/DOCX       │  │   ║
║  │  │ WhatsApp  │  │  │       │       │  │  │  - Images         │  │   ║
║  │  │ Gateway   │  │  │       │       │  │  └─────────┬──────────┘  │   ║
║  │  └───────────┘  │  │       │       │  │            │             │   ║
║  └─────────────────┘  │       │       │  │  ┌─────────▼──────────┐  │   ║
║                       │       │       │  │  │  TF-IDF Vector    │  │   ║
║                       │       │       │  │  │  Store (Local)    │  │   ║
║                       │       │       │  │  │  - Fast keyword   │  │   ║
║                       │       │       │  │  │  - In-memory      │  │   ║
║                       │       │       │  │  └─────────┬──────────┘  │   ║
║                       │       │       │  │            │             │   ║
║                       │       │       │  │  ┌─────────▼──────────┐  │   ║
║                       │       │       │  │  │  Memory Bridge    │  │   ║
║                       │       │       │  │  │  ┌──────────────┐ │  │   ║
║                       │       │       │  │  │  │ Singleton    │ │  │   ║
║                       │       │       │  │  │  │ HTTP Client  │ │  │   ║
║                       │       │       │  │  │  │ Format Conv. │ │  │   ║
║                       │       │       │  │  │  │ Graceful     │ │  │   ║
║                       │       │       │  │  │  │ Degradation  │ │  │   ║
║                       │       │       │  │  │  └──────┬───────┘ │  │   ║
║                       │       │       │  │  └─────────┼──────────┘  │   ║
║                       │       │       │  │            │             │   ║
║                       └───────┼───────┘  └────────────┼─────────────┘   ║
║                               │                       │                   ║
║                               │  HTTP API             │                   ║
║                               │  /v1/memories         │                   ║
║                               │  /v1/memories/search  │                   ║
║                               └───────────────────────┘                   ║
║                                                                           ║
╠═══════════════════════════════════════════════════════════════════════════╣
║                          DATABASE LAYER                                   ║
╠═══════════════════════════════════════════════════════════════════════════╣
║                                                                           ║
║  ┌──────────────────────────────┐    ┌──────────────────────────────┐   ║
║  │  PostgreSQL 16               │    │  Redis 7                     │   ║
║  │  (Port 5432)                 │    │  (Port 6379)                 │   ║
║  │  ┌────────────────────────┐  │    │  ┌────────────────────────┐ │   ║
║  │  │ User Data              │  │    │  │ Session Cache          │ │   ║
║  │  │ Document Metadata      │  │    │  │ Query Cache            │ │   ║
║  │  │ Memory Graph           │  │    │  │ Rate Limiting          │ │   ║
║  │  │ Vector Embeddings      │  │    │  │ Pub/Sub                │ │   ║
║  │  │ Relationships          │  │    │  └────────────────────────┘ │   ║
║  │  └────────────────────────┘  │    │                             │   ║
║  │  Volume: postgres_data       │    │  Volume: redis_data         │   ║
║  └──────────────────────────────┘    └──────────────────────────────┘   ║
║                                                                           ║
╠═══════════════════════════════════════════════════════════════════════════╣
║                       MANAGEMENT & MONITORING                             ║
╠═══════════════════════════════════════════════════════════════════════════╣
║                                                                           ║
║  ┌───────────────────────────────────────────────────────────────────┐   ║
║  │  Portainer CE (Port 9443)                                         │   ║
║  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │   ║
║  │  │ Container   │  │  Stacks     │  │  Logs & Monitoring      │  │   ║
║  │  │ Management  │  │  Deploy     │  │  Resource Usage         │  │   ║
║  │  └─────────────┘  └─────────────┘  └─────────────────────────┘  │   ║
║  └───────────────────────────────────────────────────────────────────┘   ║
║                                                                           ║
║  ┌───────────────────────────────────────────────────────────────────┐   ║
║  │  UFW Firewall                                                     │   ║
║  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────────────┐    │   ║
║  │  │ SSH: 22  │ │HTTP: 80  │ │HTTPS:443 │ │Services:50001-   │    │   ║
║  │  │          │ │          │ │          │ │50004,3389,9443   │    │   ║
║  │  └──────────┘ └──────────┘ └──────────┘ └──────────────────┘    │   ║
║  └───────────────────────────────────────────────────────────────────┘   ║
║                                                                           ║
╠═══════════════════════════════════════════════════════════════════════════╣
║                       EXTERNAL INTEGRATIONS                               ║
╠═══════════════════════════════════════════════════════════════════════════╣
║                                                                           ║
║  API Integrations (via Environment Variables)                            ║
║  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────────┐    ║
║  │ GROQ API   │  │ Gemini API │  │ Novita API │  │ Anthropic API  │    ║
║  │ (LLM)      │  │ (LLM)      │  │ (TTS/Image)│  │ Claude (Future)│    ║
║  └────────────┘  └────────────┘  └────────────┘  └────────────────┘    ║
║                                                                           ║
║  ┌──────────────────────────────────────────────────────────────────┐    ║
║  │  Claude Desktop (Windows - via MCP)                              │    ║
║  │  ┌────────────────────────────────────────────────────────────┐ │    ║
║  │  │  Model Context Protocol                                     │ │    ║
║  │  │  → http://memory.veritas.alunaafrica.cloud/mcp             │ │    ║
║  │  │  → http://vault.veritas.alunaafrica.cloud/mcp              │ │    ║
║  │  └────────────────────────────────────────────────────────────┘ │    ║
║  └──────────────────────────────────────────────────────────────────┘    ║
║                                                                           ║
╚═══════════════════════════════════════════════════════════════════════════╝


═══════════════════════════════════════════════════════════════════════════════
                              DATA FLOW DIAGRAM
═══════════════════════════════════════════════════════════════════════════════

USER UPLOADS WHATSAPP EXPORT
             │
             ▼
    ┌────────────────────┐
    │  CogniVault UI     │
    │  (Streamlit)       │
    └────────┬───────────┘
             │
             ▼
    ┌────────────────────────────────────────┐
    │  WhatsApp Export Processor             │
    │  - Parse chat format                   │
    │  - Extract messages (15,234)           │
    │  - Parse metadata (sender, timestamp)  │
    │  - Detect media references             │
    └────────┬───────────────────────────────┘
             │
             ├───────────────────────┐
             │                       │
             ▼                       ▼
    ┌─────────────────┐    ┌─────────────────────┐
    │  TF-IDF Vector  │    │  Memory Bridge      │
    │  Store (Local)  │    │                     │
    │  ┌───────────┐  │    │  ┌───────────────┐ │
    │  │ Immediate │  │    │  │ Format for    │ │
    │  │ Indexing  │  │    │  │ Mem0 API      │ │
    │  │ <50ms     │  │    │  │               │ │
    │  │           │  │    │  │ Add metadata  │ │
    │  │ Keyword   │  │    │  │ Entity tags   │ │
    │  │ Search    │  │    │  │               │ │
    │  └───────────┘  │    │  └───────┬───────┘ │
    └─────────────────┘    └──────────┼─────────┘
                                      │
                                      │ HTTP POST
                                      │ /v1/memories
                                      ▼
                         ┌────────────────────────┐
                         │  Aluna-Memory (Mem0)   │
                         │  ┌──────────────────┐  │
                         │  │ Semantic         │  │
                         │  │ Embeddings       │  │
                         │  │ (via LLM)        │  │
                         │  └────────┬─────────┘  │
                         │           │            │
                         │  ┌────────▼─────────┐  │
                         │  │ Graph Database   │  │
                         │  │ - Relationships  │  │
                         │  │ - Context        │  │
                         │  │ - Time series    │  │
                         │  └────────┬─────────┘  │
                         │           │            │
                         │  ┌────────▼─────────┐  │
                         │  │ Long-term Store  │  │
                         │  │ (PostgreSQL)     │  │
                         │  └──────────────────┘  │
                         └────────────────────────┘

USER SEARCHES: "AI project discussions"
             │
             ▼
    ┌────────────────────┐
    │  Search Query      │
    │  Natural Language  │
    └────────┬───────────┘
             │
             ├───────────────────────┐
             │                       │
             ▼                       ▼
    ┌─────────────────┐    ┌─────────────────────┐
    │  TF-IDF Search  │    │  Semantic Search    │
    │  (Local)        │    │  (Mem0)             │
    │  ┌───────────┐  │    │  ┌───────────────┐ │
    │  │ "AI"      │  │    │  │ Understands:  │ │
    │  │ "project" │  │    │  │ - ML          │ │
    │  │ "discuss" │  │    │  │ - LLM         │ │
    │  │           │  │    │  │ - Dev         │ │
    │  │ Results   │  │    │  │ - Coding      │ │
    │  │ (fast)    │  │    │  │               │ │
    │  └───────────┘  │    │  │ Context-aware │ │
    │                 │    │  │ Results       │ │
    └────────┬────────┘    └──────────┬────────┘
             │                        │
             │                        │
             └────────┬───────────────┘
                      │
                      ▼
         ┌────────────────────────┐
         │  Hybrid Results        │
         │  ┌──────────────────┐  │
         │  │ Merge & Rank     │  │
         │  │ - Relevance      │  │
         │  │ - Recency        │  │
         │  │ - Context        │  │
         │  └────────┬─────────┘  │
         │           │            │
         │  ┌────────▼─────────┐  │
         │  │ Display Results  │  │
         │  │ with metadata    │  │
         │  └──────────────────┘  │
         └────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                           DEPLOYMENT WORKFLOW
═══════════════════════════════════════════════════════════════════════════════

Windows Desktop
      │
      │ PowerShell: Deploy-Veritas-VPS.ps1
      ▼
  ┌─────────────────────────────────────┐
  │ 1. Check SSH client                  │
  │ 2. Download setup script             │
  │ 3. Connect to VPS                    │
  │ 4. Upload and execute                │
  └────────────┬────────────────────────┘
               │
               ▼
    VPS: veritas.alunaafrica.cloud
               │
  ┌────────────▼───────────────────────┐
  │ VERITAS_VPS_COMPLETE_SETUP.sh      │
  │                                    │
  │ 1. Update system                   │
  │ 2. Install Docker                  │
  │ 3. Install Portainer               │
  │ 4. Install XFCE + XRDP             │
  │ 5. Install VS Code                 │
  │ 6. Clone repositories              │
  │ 7. Create Docker configs           │
  │ 8. Generate passwords              │
  │ 9. Configure firewall              │
  │ 10. Create management scripts      │
  └────────────┬───────────────────────┘
               │
               ▼
  ┌────────────────────────────────────┐
  │ Manual Configuration Required      │
  │                                    │
  │ 1. passwd (set root password)      │
  │ 2. nano /opt/veritas/.env          │
  │    - GROQ_API_KEY                  │
  │    - GEMINI_API_KEY                │
  │    - NOVITA_API_KEY                │
  │ 3. DNS configuration (Hostinger)   │
  └────────────┬───────────────────────┘
               │
               ▼
  ┌────────────────────────────────────┐
  │ Start Services                     │
  │ cd /opt/veritas                    │
  │ ./start-services.sh                │
  │                                    │
  │ Docker Compose:                    │
  │  - PostgreSQL ✓                    │
  │  - Redis ✓                         │
  │  - Aluna-Memory ✓                  │
  │  - CogniVault ✓                    │
  └────────────┬───────────────────────┘
               │
               ▼
  ┌────────────────────────────────────┐
  │ SSL Setup (after DNS propagation)  │
  │ cd /opt/veritas                    │
  │ ./setup-ssl.sh                     │
  │                                    │
  │ Let's Encrypt certificates for:    │
  │  - vault.veritas.alunaafrica.cloud │
  │  - memory.veritas.alunaafrica.cloud│
  └────────────┬───────────────────────┘
               │
               ▼
  ┌────────────────────────────────────┐
  │ Access Services                    │
  │                                    │
  │ https://vault.veritas...  :50004   │
  │ https://memory.veritas... :50003   │
  │ https://72.62.235.217:9443         │
  │ RDP: 72.62.235.217:3389            │
  └────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════
                              SECURITY LAYERS
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────┐
│ Layer 1: Network Security                                       │
│  - UFW Firewall (whitelist only)                                │
│  - fail2ban (brute force protection)                            │
│  - SSH key-based auth (optional)                                │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Layer 2: Application Security                                   │
│  - HTTPS/SSL (Let's Encrypt)                                    │
│  - Nginx reverse proxy                                          │
│  - Rate limiting (Redis)                                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Layer 3: Container Isolation                                    │
│  - Docker networks                                              │
│  - Service isolation                                            │
│  - Resource limits                                              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Layer 4: Data Security                                          │
│  - PostgreSQL authentication                                    │
│  - Redis password protection                                    │
│  - Encrypted at rest (LUKS - optional)                          │
│  - Automated backups                                            │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│ Layer 5: API Security                                           │
│  - API key authentication                                       │
│  - Environment variable isolation                               │
│  - Secret management (.env with 600 permissions)                │
└─────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════
Built by VERITAS - 150% Production Standard
Rob "The Sounds Guy" Barenbrug - 2026-01-30
═══════════════════════════════════════════════════════════════════════════════
```
